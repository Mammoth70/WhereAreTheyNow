## История WhereAreTheyNow?

Нумерация версий использует следующий формат:  

Major.Minor.Patch  

Major - крупные изменения и добавления, а также, изменения, которые делают приложения с разными Major версиями несовместимыми полностью или частично.  
Minor - небольшие изменения, влияющие на ход выполнения приложения или на интерфейс.  
Patch - совсем незначительные изменения.  

Обычно, нумерация версий идёт по порядку. До версии 3.11 использовался формат Major.Minor.

### 1.01 - 1.11
Ранние версии. (Не выкладывались на github).

### 2.01 - 2.14
Ранние версии. (Не выкладывались на github).

### 2.15
Первая версия, выложенная на github.  

В activity "Карточка контакта" слева от полей ввода добавлены иконки.  

В activity "Карточка контакта", и в activity "Настройки" у полей ввода телефона настроены шаблоны разрешённых символов.  

У полей ввода ограничен размер (20 символов для телефона, 25 символов для контакта).  

В activity "Карточка контакта" поля ввода теперь переходят в статус ошибки, если при сохранении они не заполнены.

### 2.16
Метод setfabStatus() переведён в private.  

В activity "Яндекс-карты" добавлен вывод toast с координатами при тапе на метке.  

В activity "Карточка контакта" поле выбора метки переходит в статус ошибки, если при сохранении метка не выбрана.  

При выборе поля статус ошибки теперь сбрасывается.

### 2.17
Контекстное меню в главной activity теперь создаётся не программно, а из ресурса menu.

### 2.18
В activity "Яндекс-карты" к toast с координатами при тапе на метке добавлено имя контакта.  

Все ресурсы меток получили цвета из ресурса colors, а обводку из ресурса themes.  

Для activity "Карточка контакта" сделаны ресурсы прозрачной (не выбранной метки) и метки в статусе ошибки.  

В activity "Карточка контакта" все тексты статусов ошибок стали информативными.  

В activity "Разрешения" сменены цвета. Запрещённые разрешения показаны цветом colorError.  

Подкорректирован зелёный цвет включённых разрешений.  

Удалены неиспользуемые ресурсы.  

Исправлена ошибка, из-за которой в activity "Яндекс-карты" при отключении показа круга отключались и надписи над метками.

### 2.19
В activity "Яндекс-карты" настройки стиля текста над меткой вынесены в отдельный метод, а настройки цвета текста над меткой и обводки теперь выбираются из ресурса themes, вместо ресурса colors.  

В activity "Настройки" добавлено поле настройки радиуса круга для Яндекс-карты.  

### 2.20
В ресурсе themes созданы атрибуты colorGranted и colorDenied для включённых и запрещённых разрешений, атрибутам назначены цвета.  

В activity "Разрешения" цвета включённых и запрещённых разрешений теперь выбираются из ресурса themes, вместо ресурса colors.  

В activity "Карточка контакта" цвета теперь выбираются из ресурса themes, вместо ресурса colors.  

### 2.21
В activity "Настройки" теперь показываются только те настройки, которые применимы к выбранной карте или имеют смысл.  

Список настроек меняется сразу при выборе карты.  

### 2.22
В about box подправлены цвета. Цвета в TextView для about box теперь берутся из ресурса styles.  

Все цвета (кроме меток) теперь определяются темами и стилями, и больше не берутся из ресурса colors.  

### 2.23
Из кода и ресурсов удалены неиспользуемые определения.

### 2.24
Добавлены ресурсы иконок ночной темы для кнопок FAB и ActionBar. Скорректированы цвета у аналогичных иконок дневной темы.

### 2.25
Удалены все png ресурсы иконок. Векторные ресурсы иконок сделаны универсальными для дневной и ночной тем.

### 2.26
Включена поддержка динамического цвета, поэтому приложение будет работать только на Android 12 и выше.  
Добавлена динамическая тема, сгенерированная из цвета обоев пользователя.  
Добавлены красная, жёлтая, зелёная и синяя темы.  

Переписаны класс SMSMonitor и метод sendSMS под Android 12 (API 31).

### 2.27
Произведена гармонизация цвета colorGranted для разных тем.  

Изменения в классах DBhelper, PointRecord, SMSmonitor, GetLocation.  

Добавлены drawable ресурсы ic_pin_error_48.xml и ic_pin_empty_48.xml. Изменения в методах getColorMarker и GetColoMarkerSmall.  
Методы теперь возвращают эти ресурсы в случае ошибки.  

Прочие незначительные изменения в коде.

### 3.00
Приложение переведено на Kotlin.  

Исходный код на Java перенесён в git-ветку java11.  

### 3.01
Внутренние изменения.

### 3.02
Избавились от хранения списка разрешенных телефонов одновременно в SharedPreferences и в БД SQLite.  
Список телефонов теперь хранится только в БД.

### 3.03
Запись с последними полученными координатами теперь хранится в БД SQLite вместо SharedPreferences.  

Добавлено удаление "висящих" записей из таблицы с координатами.

### 3.04
Изменения в drawable ресурсах. Удалены файлы с суффиксом "64", а файлы с суффиксом "48" переименованы. 

В activity "Карточка контакта", в activity выбора меток и в главной activity теперь используются те же ресурсы меток, что и в activity "Яндекс-карты". 

Удалены или переименованы дублирующиеся функции работы с ресурсами.

### 3.05
Настройки карт теперь передаются через переменные объекта Util, а не через intent.

### 3.06
Добавлена тема с базовыми цветами Google Material Design 3. 

Исправлена ошибка с недостающим цветом в жёлтой теме.

### 3.07
Применена тема Material Design 3 Expressive для всех кнопок FAB в activity "Яндекс-карты", теперь они стали более заметными.

### 3.08
На все activity добавлена кнопка "назад".  

На всех activity с картами изменена кнопка вызова меню.  

В activity "Яндекс-карты" при тапе на метку теперь выводятся не координаты тапа, как раньше, а координаты самой метки.  

Поправлены расстояния для кнопок FAB и IconButton, поправлены размеры и шрифты панелей.  

Внутренние изменения.

### 3.09
Все верхние панели сделаны объектами MaterialToolbar.

### 3.10
Все ListView'ы и SimpleAdapter'ы заменены на RecyclerView'ы и RecyclerView.Adapter'ы соответственно.  

Для выбора меток использован GridLayoutManager.  

Поправлены макеты списков.

В список контактов добавлена кнопка выпадающего меню и кнопка определения собственной локации.

### 3.11
Сменена нумерация версий на формат Major.Minor.Patch. Сменена числовая нумерация версий на формат versionMajor * 10000 + versionMinor * 100 + versionPatch.  

Добавлены ещё две метки, теперь их двенадцать - можно красиво разложить по две, по три и по четыре в ряд.  

Произведён рефакторинг layout-ресурсов. Удалены лишние вложенности, удалены неиспользуемые параметры.  

Изменён дизайн всех списков.  

Изменена иконка кнопки FAB в activity "Яндекс-карты".  

Изменён цвет нижней панели с кнопкой.  

Внутренние изменения. Изменения в наследовании, исправления ошибок.

### 3.12
Добавлена настройка количества колонок в activity выбора меток.  

Внутренние изменения. Исправления ошибок.

### 3.13.0
Смена версии Gradle на 9.3.0.  

Переход на AGP 9.0.0.  

Переход на встроенный Kotlin.  

Объявления зависимостей перенесены в libs.versions.toml.  

Удалены deprecated настройки в gradle.properties.  

Выполнено уменьшение размера apk. Включены соответствующие настройки в app/build.gradle.kts. Добавлен файл res/raw/keep.xml.  

Отказ от конструкции "object : PopupMenu.OnMenuItemClickListener" при создании меню.  

Отказ от использования android:onClick в макетах. Вместо этого сделаны программные установки листенера через setOnClickListener.  

Привязки листенеров в адаптерах перенесены в конструкторы из API функций.  
Установки листенеров в адаптерах перенесены из onBindViewHolder в Init.  

Изменение года разработки приложения в ресурсах strings.xml.  

Внутренние изменения.

### 3.13.1
Переименование макетов.  
Для переиспользуемых макетов (include) применяется префикс partial_. Для диалога - префикс dialog_.

### 3.13.2
Изменения в ресурсах.  
В меню удалены группы.

### 3.14.0
Большие изменения в архитектуре проекта.  

Добавлен data class User для хранения всех полей контакта.  
Добавлен object DataRepository - основной список объектов. В результате, избавились от большого количества несвязанных HashMap.  

Класс DBhelper переписан для работы с DataRepository. Вызовы DBhelper мимо DataRepository больше не применяются.  
Оптимизированы SQL-вызовы.  

Адаптеры UsersAdapter и GeoAdapter переписаны для работы с DataRepository.  
В UsersAdapter используется ListAdapter, добавлен DiffUtil.ItemCallback.  

Добавлен object SettingsManager. В него перенесено всё управление переменными настроек, а также чтение и запись настроек из SharedPreferences. Некоторые настройки кешируются в памяти.  

Изменения в классах GetLocation и GetLocationService. GetLocationService переведён в Foreground-режим, добавлен NotificationChannel. Добавлен Callback для остановки сервиса.  
В GetLocation используется fusedLocationClient.getCurrentLocation.  

Сделан более "умным" возврат в MainActivity из SettingsActivity.  

Исправлена ошибка подсчёта разности дат в функции timePassed.

### 3.14.0
В файлах исходного кода и ресурсов разделители \r\n заменены на \n.